<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta charset="utf-8"/>
<meta name="description" content="Record SMA-X history in PostgreSQL / TimescaleDB"/>
<meta name="keywords" content="SMA-X PostgreSQL connector, structured data, data exchange, C, C++, C99, software library, open source, PostgreSQL, TimescaleDB, time-series history"/>
<meta name="author" content="Attila Kovacs"/>
<meta name="copyright" content="(C)2024 Attila Kovacs" />
<meta name="robots" content="index,follow"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GMGK5XDS48"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GMGK5XDS48');
</script>
<link rel="shortcut icon" type="image/x-icon" href="/redisx/resources/favicon.ico" />
<link rel="icon" type="image/png" sizes="192x192" href="/redisx/resources/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="/redisx/resources/android-chrome-512x512.png" />
<link rel="apple-touch-icon" type="image/png" href="/redisx/resources/apple-touch-icon.png" />
<title>smax-postgres: smax-postgres</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="smithsonian-logo-55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">smax-postgres<span id="projectnumber">&#160;v0.9</span>
   </div>
   <div id="projectbrief">PostgreSQL / TimescaleDB logger for SMA-X</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">smax-postgres </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README-smax-postgres"></a> Record <a href="https://docs.google.com/document/d/1eYbWDClKkV7JnJxv4MxuNBNV47dFXuUWu7C4Ve_YTf0/edit?usp=sharing">SMA-X</a> history in PostgreSQL / TimescaleDB.</p>
<ul>
<li><a href="https://smithsonian.github.io/smax-postgres/apidoc/html/files.html">API documentation</a></li>
<li><a href="https://smithsonian.github.io/smax-postgres">Project pages</a> on github.io</li>
</ul>
<p>Author: Attila Kovacs</p>
<p>Last Updated: 18 September 2024</p>
<hr  />
<h2><a class="anchor" id="autotoc_md4"></a>
Table of Contents</h2>
<ul>
<li><a class="el" href="index.html#introduction">Introduction</a></li>
<li><a class="el" href="index.html#prerequisites">Prerequisites</a></li>
<li><a class="el" href="index.html#building">Building `smax-postgres`</a></li>
<li><a class="el" href="index.html#installation">Installation</a></li>
<li><a class="el" href="index.html#database-organization">Database organization (for clients)</a></li>
<li><a class="el" href="index.html#configuration-reference">Configuration reference</a></li>
</ul>
<hr  />
<p><a class="anchor" id="introduction"></a> </p>
<h2><a class="anchor" id="autotoc_md6"></a>
Introduction</h2>
<p><code>smax-postgres</code> is a daemon application, which can collect data from an <a href="https://docs.google.com/document/d/1eYbWDClKkV7JnJxv4MxuNBNV47dFXuUWu7C4Ve_YTf0/edit?usp=sharing">SMA information eXchange (SMA-X)</a> realtime database and insert these into a <b>PostgreSQL</b> database to create a time-series historical record for all or selected SMA-X variables. The program is highly customizable and supports both regular updates for changing variables as well as regular snapshots of all selected SMA-X variables.</p>
<p><a class="anchor" id="prerequisites"></a> </p>
<h2><a class="anchor" id="autotoc_md7"></a>
Prerequisites</h2>
<p>The <code>smax-postgres</code> application has build and runtime dependencies on the following software:</p>
<ul>
<li><b>PostgreSQL</b> installation and development files (<code>libpq.so</code> and <code>lipq.fe.h</code>).</li>
<li><a href="https://github.com/Smithsonian/smax-clib">Smithsonian/smax-clib</a></li>
<li><a href="https://github.com/Smithsonian/redisx">Smithsonian/redisx</a></li>
<li><a href="https://github.com/Smithsonian/xchange">Smithsonian/xchange</a></li>
<li><b>Popt</b> development libraries (<code>libpopt-dev</code>in Debian, or <code>popt-devel</code> in RPM distros)</li>
<li>(<em>optional</em>) <b>TimescaleDB</b> extensions.</li>
<li>(<em>optional</em>) <b>systemd</b> development files (<code>libsystemd.so</code> and <code>sd-daemon.h</code>).</li>
</ul>
<p>Additionally, to configure your SMA-X server, you will need the <a href="https://github.com/Smithsonian/smax-server">Smithsonian/smax-server</a> repo also.</p>
<hr  />
<p><a class="anchor" id="building"></a> </p>
<h2><a class="anchor" id="autotoc_md9"></a>
Building &lt;tt&gt;smax-postgres&lt;/tt&gt;</h2>
<p>You can configure the build, either by editing <code>config.mk</code> or else by defining the relevant environment variables prior to invoking <code>make</code>. The following build variables can be configured:</p>
<ul>
<li><code>PGDIR</code>: Root directory of a specific PostgreSQL installation to build against (not set by default).</li>
<li><code>XCHANGE</code>: the root of the location where the <a href="https://github.com/Smithsonian/xchange">Smithsonian/xchange</a> library is installed. It expects to find <code><a class="elRef" href="../../xchange/apidoc/html/xchange_8h.html">xchange.h</a></code> under <code>$(XCHANGE)/include</code> and <code>libxchange.so</code> under <code>$(XCHANGE)/lib</code> or else in the default <code>LD_LIBRARY_PATH</code>.</li>
<li><code>REDISX</code>: the root of the location where the <a href="https://github.com/Smithsonian/redisx">Smithsonian/redisx</a> library is installed. It expects to find <code><a class="elRef" href="../../redisx/apidoc/html/redisx_8h.html">redisx.h</a></code> under <code>$(REDISX)/include</code> and <code>libredisx.so</code> under <code>$(REDISX)/lib</code> or else in the default <code>LD_LIBRARY_PATH</code>.</li>
<li><code>SMAXLIB</code>: the root of the location where the <a href="https://github.com/Smithsonian/smax-clib">Smithsonian/smax-clib</a> library is installed. It expects to find <code><a class="elRef" href="../../smax-clib/apidoc/html/smax_8h.html">smax.h</a></code> under <code>$(SMAXLIB)/include</code> and <code>libsmax.so</code> under <code>$(SMAXLIB)/lib</code> or else in the default <code>LD_LIBRARY_PATH</code>.</li>
<li><code>SYSTEMD</code>: Sets whether to compile with SystemD integration (needs <code>libsystemd.so</code> and <code>sd-daemon.h</code>). Default is 1 (enabled).</li>
<li><code>CC</code>: The C compiler to use (default: <code>gcc</code>).</li>
<li><code>CPPFLAGS</code>: C preprocessor flags, such as externally defined compiler constants.</li>
<li><code>CFLAGS</code>: Flags to pass onto the C compiler (default: <code>-Os -Wall -std=c99</code>). Note, <code>-Iinclude</code> will be added automatically.</li>
<li><code>LDFLAGS</code>: Extra linker flags (default: <em>not set</em>). Note, <code>-lm -pthread -lsmax -lredisx -lxchange -lpq -lpopt</code> will be added automatically.</li>
<li><code>BUILD_MODE</code>: You can set it to <code>debug</code> to enable debugging features: it will initialize the global <code>xDebug</code> variable to <code>TRUE</code> and add <code>-g</code> to <code>CFLAGS</code>.</li>
<li><code>CHECKEXTRA</code>: Extra options to pass to <code>cppcheck</code> for the <code>make check</code> target</li>
</ul>
<p>After configuring, you can simply run <code>make</code>, which will build <code>bin/smax-postgres</code>, and user documentation. You may also build other <code>make</code> target(s). (You can use <code>make help</code> to get a summary of the available <code>make</code> targets).</p>
<p>Now you may compile <code>smax-postgres</code>:</p>
<div class="fragment"><div class="line">$ make</div>
</div><!-- fragment --><hr  />
<p><a class="anchor" id="installation"></a> </p>
<h2><a class="anchor" id="autotoc_md11"></a>
Installation</h2>
<p>Prior to installation, you should check that the PostgreSQL service name is correct in <code>smax-postgres.service</code>, and edit it as necessary for your system configuration. You may also edit the <code>cfg/smax-postgres.cfg</code> now, or after it is installed.</p>
<p>Provided the build was successful, you can install the executables, configuration files, and optionally the SystemD unit files via:</p>
<div class="fragment"><div class="line">$ sudo make install</div>
</div><!-- fragment --><p>(When installing at the SMA, you may want <code>make install-sma</code> instead, to install with SMA-specific configuration). In case of SystemD integration you should also reload the SystemD daemon so <code>smax-postgres.service</code> can be enabled and managed as desired:</p>
<div class="fragment"><div class="line">$ sudo systemd daemon-reload</div>
</div><!-- fragment --><p>After that you can start the service as:</p>
<div class="fragment"><div class="line">$ sudo systemd start smax-postgres</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md12"></a>
Staging / advanced installation</h3>
<p>By default, <code>make install</code> will install the <code>smax-postgress</code> executable to <code>/usr/bin</code>, configuration under <code>/etc/</code>, SystemD service unit under <code>/etc/systemd/system</code>, and documentation under <code>/usr/share/doc/smax-postgres/</code>. Instead of <code>/usr</code>, you may want to install into another destination, such as <code>/opt/</code> or <code>/usr/local</code>. You can do that by setting the <code>DESTDIR</code> environment prior to <code>make install</code>, e.g.:</p>
<div class="fragment"><div class="line">$ export DESTDIR=&quot;/opt&quot;</div>
</div><!-- fragment --><p>Additionally, you can also stage the installation under a different root, by setting the <code>PREFIX</code> environment variable, e.g.:</p>
<div class="fragment"><div class="line">$ export PREFIX=&quot;~/rmpbuild/BUILD/smax-postgres&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md13"></a>
Standard error/output with SystemD integration</h3>
<p>In case of SystemD integration, errors will get logged to the journal, and can be investigated by <code>journalctl</code>. E.g. to see the errors in the last 3 hours, you may:</p>
<div class="fragment"><div class="line">$ journalctl -u smax-postgres --since &quot;3 hours ago&quot;</div>
</div><!-- fragment --><p>Standard output is logged to the file <code>/var/log/smax-postgres.out</code> for the current session. Restarting <code>smax-postgres</code> will start a new file. (Because of buffering, there may be a long lag before you'll see stuff appear in this log file.)</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Initial setup of the SQL database</h3>
<p>Prior to using <code>smax-postgres</code>, you will need to configure users and access privileges (roles) for the database, and may want to create the database instance manually. You will need to create a user designated for the <code>smax-postgres</code> program, and specify its credentials in the <code>smax-postgres</code> configuration file. This user will not require <code>CREATEDB</code> permission, but it will need permission to create tables in the existing database and to insert data or to search the tables (i.e. read/write privileges). Additionally, you may also create the designated database instance assigned to whatever user to own. If you create the database manually, do not forget to set the name of the designated database in the <code>smax-postgres</code> configuration file.</p>
<p>Normally <code>smax-postgres</code> will assume that the database to use has been fully set up, including a 'titles' table (containing 2 columns: <em>text</em> variable IDs, and auto-incremented integer <em>serial</em> numbers). However, <code>smax-postgres</code> can create the database and set up the required 'titles' table as needed (including indexing, and TimescaleDB extension as appropriate), when launched with the <code>-b</code> (or <code>--bootstrap</code>) option.</p>
<div class="fragment"><div class="line">$ smax-postgres -c /usr/local/etc/smax-postgres/myconfig.cfg -b</div>
</div><!-- fragment --><p>Will log into the existing (new) database using the credentials specified in the configuration file <code>/usr/local/etc/smax-postgres/myconfig.cfg</code>, then configures that database (e.g. set up the TimescaleSB extension as appropriate), and creates the 'titles' table and its index.</p>
<p>You may also let the bootstrapping process create the database itself, in which case you may have to provide the password for the 'postgres' admin account, or the credentials for another account with <code>CREATEDB</code> privileges with the necessary privileges to create databases. E.g.:</p>
<div class="fragment"><div class="line">$ smax-postgres -c /usr/local/etc/myconfig.cfg -b -p &quot;S3cur1ty!&quot;</div>
</div><!-- fragment --><p>will attempt create the database as the 'postgres' admin, before proceeding to configure the newly created database as the user designated for the <code>smax-postgres</code> program. (Alternatively, you may use the <code>-a</code> and <code>-p</code> options together to create the database with another privileged user). The newly created database will be automatically assigned to the designated <code>smax-postgres</code> user as its owner).</p>
<p>Once the database is configured, you will not need the <code>-b</code> option again (but it also will not wreck the previous initialization if accidentally used again after the initial setup).</p>
<hr  />
<p><a class="anchor" id="database-organization"></a> </p>
<h2><a class="anchor" id="autotoc_md16"></a>
Database organization (for clients)</h2>
<p>Each SMA-X variable has its own time-series data table in the SQL DB. These tables are named <code>var_&lt;tid&gt;</code>, where <code>&lt;tid&gt;</code> is a 6-digit serial number, e.g. <code>var_000001</code> for the first variable added to the SQL database. The variable name to <code>&lt;tid&gt;</code> pairings are listed in the <code>titles</code> table, which contains just two columns: (1) the full SMA-X variable id (<em>text</em>), and (2) the corresponding <code>&lt;tid&gt;</code> (integer <em>serial</em>) used in the SQL database to store the time series of the variable. (Thus, to figure out what table stored data for a given SMA-X variable you will need to search the 'titles' table for the <code>&lt;tid&gt;</code> first.)</p>
<p>The time series data in the <code>var_&lt;tid&gt;</code> tables contains (at least) 2 + <code>n</code> columns for an SMA-X variable, which has <code>n</code> array elements. The first column is the UTC timestamp at which the data was pulled from the SMA-X database. The second is an integer 'age' (in seconds) that informs how much before the pull was the last time that variable was updated in the SMA-X database. After that, the remaining columns list the array elements stored in the SMA-X variable. (Thus scalar entries will have just one additional column, labeled as 'c0').</p>
<p>Because the SMA-X variables may have dynamic types and array dimensions, the SQL tables may automatically expand to an enclosing type (for example if a variable changes from <code>int16</code> to <code>int32</code> or to a <code>float32</code>), and columns will be added as necessary to store an expanded set of array elements. When SMA-X data 'shrinks', containing fewer elements than the existing SQL record, the SQL entry will be padded with <code>NULL</code> values as necessary.</p>
<p>In addition to the time-series data stored in the SQL database, it also stores versioned metadata in tables with matching <code>&lt;tid&gt;</code> values. For example, the metadata for the time-series <code>var_000001</code> is stored in the table <code>var_000001_meta</code>. Metadata tables contained serial-numbered versions of infrequently changing metadata, such as array dimensions and shapes (scalar values are stored with <code>ndim = 0</code> and <code>shape = NULL</code>), associated physical units, and downsampling factors. Each metadata entry is timestamped also to indicate when a change (if any) occurred in these characteristics.</p>
<p>Thus, to query an SMA-X variable <code>system:subsystem:property</code>, you first want to find the 'tid' of the variable in 'titles':</p>
<div class="fragment"><div class="line"><span class="keyword">SELECT</span> tid <span class="keyword">FROM</span> titles <span class="keyword">WHERE</span> name = <span class="stringliteral">&#39;system.subsystem.property&#39;</span>;</div>
</div><!-- fragment --><p>Say the query returns the tid <code>192</code>, then the time-series for that variable will be stored in the table named <code>var_000192</code>, while metadata versions are stored in the table named <code>var_000192_meta</code>.</p>
<hr  />
<p><a class="anchor" id="configuration-reference"></a> </p>
<h2><a class="anchor" id="autotoc_md18"></a>
Configuration Reference</h2>
<p>See <code>cfg/example.cfg</code> as an example configuration file. Based on it may create your own configuration file, which you can then load via the <code>-c</code> option to <code>smax-postgres</code> at startup. If using SystemD integration, you may want to update <code>/etc/systemd/system/smax-postgres.service</code> to load the configuration file from the location of your choice when the service is started via <code>systemd</code>.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Database configuration options</h3>
<h4><a class="anchor" id="autotoc_md20"></a>
&lt;tt&gt;smax_server &lt;host&gt;&lt;/tt&gt;</h4>
<p>Host name or IP address of the SMA-X server (default 'smax').</p>
<h4><a class="anchor" id="autotoc_md21"></a>
&lt;tt&gt;sql_auth &lt;password&gt;&lt;/tt&gt;</h4>
<p>Password for authenticating user on the SQL server (no default).</p>
<h4><a class="anchor" id="autotoc_md22"></a>
&lt;tt&gt;sql_db&lt;/tt&gt; &lt;db-name&gt;`</h4>
<p>SQL database name to use (default is 'smax_db').</p>
<h4><a class="anchor" id="autotoc_md23"></a>
&lt;tt&gt;sql_server &lt;host&gt;&lt;/tt&gt;</h4>
<p>Host name or IP address of the SMA-X server (default 'localhost').</p>
<h4><a class="anchor" id="autotoc_md24"></a>
&lt;tt&gt;sql_user &lt;user-name&gt;&lt;/tt&gt;</h4>
<p>SQL user name to use (default is 'smax_db').</p>
<h4><a class="anchor" id="autotoc_md25"></a>
&lt;tt&gt;use_hypertables &lt;1|0&gt;&lt;/tt&gt;</h4>
<p>Determines whether to create hypertables via the TimescaleDB extension. The value 1 enables, 0 disables the used of hypertables (the default is to not use hypertables). TimescaleDB hypertables allow for faster access of time series data by organizing large datasets into smaller blocks of data, which can be handled more efficiently.</p>
<h3><a class="anchor" id="autotoc_md26"></a>
Update frequency options</h3>
<h4><a class="anchor" id="autotoc_md27"></a>
interval specification</h4>
<p>Timescales may be specified by a numeric value (integer or decimal) followed immediately by a unit designator, such as '1d' for one day. Alternatively, the value 'none' can be used to disable a timescale-specific option. The following timescale units are understood:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">unit   </th><th class="markdownTableHeadNone">description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>s</code>   </td><td class="markdownTableBodyNone">second(s)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>m</code>   </td><td class="markdownTableBodyNone">minute(s)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>h</code>   </td><td class="markdownTableBodyNone">hour(s)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>d</code>   </td><td class="markdownTableBodyNone">day(s)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>w</code>   </td><td class="markdownTableBodyNone">week(s)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>y</code>   </td><td class="markdownTableBodyNone">year(s)   </td></tr>
</table>
<h4><a class="anchor" id="autotoc_md28"></a>
&lt;tt&gt;snapshot_interval &lt;interval&gt;&lt;/tt&gt;</h4>
<p>Specifies the interval at which all designated variables are pushed into the SQL database, regardless whether they have changed or not since the last time they were pushed (default '1h'). See the section further above on interval specifications.</p>
<h4><a class="anchor" id="autotoc_md29"></a>
&lt;tt&gt;update_interval &lt;interval&gt;&lt;/tt&gt;</h4>
<p>Specifies the regular interval at which to push changing variables into the database (default: '1m'). See the section furtherabove on interval specifications. Variables that have no changed since the last update will be excluded from the regular updates until it is time for the next full snapshot. The snapshot interval is controlled separately (see above).</p>
<h3><a class="anchor" id="autotoc_md30"></a>
Variable-specific options</h3>
<h4><a class="anchor" id="autotoc_md31"></a>
glob patterns</h4>
<p>SMA-X variables can be specified individually or via <a href="https://man7.org/linux/man-pages/man7/glob.7.html">glob patterns</a>, similarly to how these are used in UNIX shells.</p>
<h4><a class="anchor" id="autotoc_md32"></a>
&lt;tt&gt;always &lt;pattern&gt;&lt;/tt&gt;</h4>
<p>Specifies a variable or a glob pattern of variables, which are to be logged into the SQL database regardless of all other directives, which may otherwise limit if and when they are to be pushed. Reserve using this option only for the most critical cases, when the other configuration options do not provide the desired level of assurances for some absolutely critical data points.</p>
<h4><a class="anchor" id="autotoc_md33"></a>
&lt;tt&gt;exclude &lt;pattern&gt;&lt;/tt&gt;</h4>
<p>Specifies a variable or a glob pattern of variables that are to be excluded from logging to the SQL database. <code>exclude</code> and <code>include</code> directives take effect in the order they were specified, so for a given variable only the last <code>include</code> or <code>exclude</code> statement, which pertains to it, will decide whether or not to log that given variable. Variables that are configured with an <code>always</code> directive will be logged to the SQL database regardless of any exclusions that may have been specified, either before or after. By default all metadata variables (ones whose name begin with <code>&lt;</code>) and all temporary variable (whose names begin with an underscore <code>_</code>) are excluded from logging, unless they are explicitly re-included.</p>
<h4><a class="anchor" id="autotoc_md34"></a>
&lt;tt&gt;include &lt;pattern&gt;&lt;/tt&gt;</h4>
<p>Specifies a variable or a glob pattern of variables that are to be excluded from logging to the SQL database. <code>exclude</code> and <code>include</code> directives take effect in the order they were specified, so for a given variable only the last <code>include</code> or <code>exclude</code> statement, which pertains to it, will decide whether or not to log that given variable. Variables that are configured with an <code>always</code> directive will be logged to the SQL database regardless of any exclusions that may have been specified, either before or after. By default, all SMA-X variables are included in the logging, except for the metadata and temporary data that are excluded by default (see <code>exclude</code>).</p>
<h4><a class="anchor" id="autotoc_md35"></a>
&lt;tt&gt;max_age &lt;interval&gt;&lt;/tt&gt;</h4>
<p>Sets a maximum age for variables to push to the SQL database (default: '90d'). Variables that have not been updated in SMA-X for longer than the specified interval will not be pushed to the SQL database. Variables that are configured with an <code>always</code> directive will be logged to the SQL database regardless of their age.</p>
<h4><a class="anchor" id="autotoc_md36"></a>
&lt;tt&gt;max_size &lt;bytes&gt;&lt;/tt&gt;</h4>
<p>Sets a maximum byte size for variables to push to the SQL database (default: '1024'). Variables that have larger binary representations (after downsampling via the <code>sampling</code> directive, if any) will not be logged to the database to avoid bloating. However, variables explicitly configured via an <code>always</code> directive will be logged to the SQL database regardless of their storage requirements.</p>
<h4><a class="anchor" id="autotoc_md37"></a>
&lt;tt&gt;sample &lt;n&gt; &lt;pattern&gt;&lt;/tt&gt;</h4>
<p>Log sparse samples of data for a variable or a glob pattern of variables. In some cases you may store large arrays in the SMA-X database, logging of which may bloat the time series history stored in the SQL database. However, you may want to still get a preview of what that data was, by storing every n'th sample of the original only. For example, for an array with 1000 entries, you may want to store say 20 samples. Setting <code>&lt;n&gt;</code> to 50 will achieve that, by storing every 50th element in the SQL database only. (Still, the SQL database will store the original dimensionality of the downsampled variables, and note the downsampling factor used also as metadata).</p>
<hr  />
<p> Copyright (C) 2024 Attila Kovács </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
